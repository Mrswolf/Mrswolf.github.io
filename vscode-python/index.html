<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=5,viewport-fit=cover"><title>Scientific Computing in VS Code | swolf的博客</title><meta name="description" content="I used to do all scientific computing work on Jupyter notebooks. My most common way of debugging was print, which is definitely not the best way to do so."><meta property="og:type" content="article"><meta property="og:title" content="Scientific Computing in VS Code"><meta property="og:url" content="https://mrswolf.github.io/vscode-python/index.html"><meta property="og:site_name" content="swolf的博客"><meta property="og:description" content="I used to do all scientific computing work on Jupyter notebooks. My most common way of debugging was print, which is definitely not the best way to do so."><meta property="og:locale" content="en_US"><meta property="og:image" content="https://mrswolf.github.io/vscode-python/formatter.png"><meta property="og:image" content="https://mrswolf.github.io/vscode-python/vscode_jupyter.png"><meta property="og:image" content="https://mrswolf.github.io/vscode-python/vscode_start_debug.png"><meta property="og:image" content="https://mrswolf.github.io/vscode-python/vscode_debug.png"><meta property="article:published_time" content="2023-06-11T12:23:45.000Z"><meta property="article:modified_time" content="2023-09-12T16:00:00.000Z"><meta property="article:author" content="swolf"><meta property="article:tag" content="vscode"><meta property="article:tag" content="python"><meta property="article:tag" content="jupyter"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://mrswolf.github.io/vscode-python/formatter.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"><link rel="icon" href="/images/favicon.ico" type="image/x-icon"><meta name="google-site-verification" content="dN2SLd9-x4zqC5VsgpROSppupvj3_eOvkDfKG32YSdc"><link rel="stylesheet" href="/css/iconfont.min.css"><link rel="stylesheet" href="/css/common.min.css"><link href="//cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css" rel="stylesheet" crossorigin="anonymous"><script async src="https://www.googletagmanager.com/gtag/js?id=G-2JPFK1G1RZ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-2JPFK1G1RZ")</script><meta name="generator" content="Hexo 6.1.0"></head><body><header class="header header-fixture"><div class="profile-search-wrap flex sm:block"><div class="profile sm:text-center md:px-1 lg:px-3 sm:pb-4 sm:pt-6"><a id="avatar" role="link" href="https://github.com/mrswolf" class="inline-block lg:w-16 lg:h-16 w-8 h-8 m-2" target="_blank" rel="noopener" rel="noreferrer"><img src="/images/avatar.jpg" class="rounded-full" alt="avatar"></a><h2 id="name" class="hidden lg:block">swolf</h2><h3 id="title" class="hidden lg:block">Engineer &amp; Coder &amp; Researcher</h3><small id="location" class="hidden lg:block"><i class="iconfont icon-map-icon"></i> Earth, Universe</small></div><div class="search flex-1 flex lg:inline-block sm:hidden lg:px-4 lg:mt-2 lg:mb-4 lg:w-full"><form id="search-form" class="my-auto flex-1 lg:border lg:border-solid lg:border-gray-200"><div class="input-group table bg-gray-100 lg:bg-white w-full"><input id="search-input" type="text" placeholder="Search" class="inline-block w-full bg-gray-100 lg:bg-white p-1"> <span class="table-cell"><button name="search tigger button" disabled><i class="iconfont icon-search m-2"></i></button></span></div></form><div id="content-json" data-placeholder="Search" class="invisible hidden">/content.json</div><script id="search-teamplate" type="text/html" data-path="/content.json"><div>
        <div class="search-header bg-gray-400">
            <input id="actual-search-input" model="keyword" ref="input" class="inline-block w-full h-10 px-2 py-1" placeholder="Search" type="text">
        </div>
        <div class="search-result bg-gray-200">
            {{#each searchPosts}}
            <a href="/{{ path }}" class="result-item block px-2 pb-3 mb-1 pt-1 hover:bg-indigo-100">
                <i class="iconfont icon-file"></i>
                <h1 class="result-title inline font-medium text-lg">{{ title }}</h1>
                <p class="result-content text-gray-600 text-sm">{{{ text }}}</p>
            </a>
            {{/each}}
        </div>
    </div></script></div><button name="menu toogle button" id="menu-toggle-btn" class="block sm:hidden p-3" role="button" aria-expanded="false"><i class="iconfont icon-hamburger"></i></button></div><nav id="menu-nav" class="hidden sm:flex flex-col"><div class="menu-item menu-home" role="menuitem"><a href="/."><i class="iconfont icon-home" aria-hidden="true"></i> <span class="menu-title">Home</span></a></div><div class="menu-item menu-archives" role="menuitem"><a href="/archives"><i class="iconfont icon-archive" aria-hidden="true"></i> <span class="menu-title">Archives</span></a></div><div class="menu-item menu-categories" role="menuitem"><a href="/categories"><i class="iconfont icon-folder" aria-hidden="true"></i> <span class="menu-title">Categories</span></a></div><div class="menu-item menu-tags" role="menuitem"><a href="/tags"><i class="iconfont icon-tag" aria-hidden="true"></i> <span class="menu-title">Tags</span></a></div><div class="menu-item menu-repository" role="menuitem"><a href="/repository"><i class="iconfont icon-project" aria-hidden="true"></i> <span class="menu-title">Repository</span></a></div><div class="menu-item menu-publications" role="menuitem"><a href="/publications"><i class="iconfont icon-folder" aria-hidden="true"></i> <span class="menu-title">Publications</span></a></div><div class="menu-item menu-about" role="menuitem"><a href="/about"><i class="iconfont icon-cup" aria-hidden="true"></i> <span class="menu-title">About</span></a></div><div class="social-links flex sm:flex-col lg:hidden mt-5"><span class="social-item text-center"><a target="_blank" rel="noopener" href="https://github.com/mrswolf"><i class="iconfont social-icon icon-github"></i> <span class="menu-title hidden lg:inline">menu.github</span> </a></span><span class="social-item text-center"><a href="/atom.xml"><i class="iconfont social-icon icon-rss"></i> <span class="menu-title hidden lg:inline">menu.rss</span></a></span></div></nav></header><section class="main-section"><main class="flex-1 px-4 py-14 md:px-5 lg:px-8 lg:py-4 relative min-h-screen"><article class="content article article-archives article-type-list" itemscope><header class="article-header"><h1 itemprop="name text-lg"><a class="article-title" href="/vscode-python" target="_blank" itemprop="url">Scientific Computing in VS Code</a></h1><p class="article-meta mb-3 text-xs"><span class="article-date"><i class="iconfont icon-calendar-check"></i><time datetime="2023-06-11T12:23:45.000Z" itemprop="datePublished">Jun11, 2023</time></span><span class="article-date"><i class="iconfont icon-calendar-check"></i><time datetime="2023-09-12T16:00:00.000Z" itemprop="datePublished">Sep13, 2023</time></span><span class="article-category"><i class="iconfont icon-folder"></i> <a class="article-category-link" href="/categories/tools/">tools</a> </span><span class="article-tags"><i class="iconfont icon-tag"></i> <a class="article-tag-none-link" href="/tags/jupyter/" rel="tag">jupyter</a>, <a class="article-tag-none-link" href="/tags/python/" rel="tag">python</a>, <a class="article-tag-none-link" href="/tags/vscode/" rel="tag">vscode</a> </span><span class="_partial/post-comment"><i class="icon icon-comment"></i> <a href="/vscode-python/#comments" class="article-comment-link">Comments </a></span><span class="post-wordcount" itemprop="wordCount">Word Count: 1.1k(words)</span> <span class="post-readcount" itemprop="timeRequired">Read Count: 6(minutes)</span></p></header><div class="marked-body article-body"><p>I used to do all scientific computing work on Jupyter notebooks. My most common way of debugging was print, which is definitely not the best way to do so. <span id="more"></span> Things got complex when I sometimes had to debug other packages installed in the Python environment. The debug mode provided in Jupyter is not very convenient. But I do like the freedom of running cells in Jupyter, which is important for testing new algorithms, so I don’t want to move my workflow to other IDEs like Pycharm.</p><p>My final choice is VS Code with its gorgeous Python extensions.</p><h2 id="Virtual-Environment">Virtual Environment</h2><p>Python has a gorgeous ecosystem of libraries and packages. Virtual environments allow user to specify which versions of dependencies and even versions of Python interpreters. Environments also provide isolation between projectes which is important for solving conficting dependencies.</p><p>I am using <strong>Conda</strong> as my environment management tool due to its ease of use. Specifically, I choose <strong><a target="_blank" rel="noopener" href="https://docs.conda.io/projects/miniconda/en/latest/">Miniconda</a></strong> which only includes essential components, allowing me to customize my environments from the ground up.</p><p>In arch linux, Miniconda is included in AUR, so just install it.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">yay -S miniconda3</span><br></pre></td></tr></table></figure><p>After the installation, it would prompt you to add conda to your terminal:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda init zsh</span><br></pre></td></tr></table></figure><p>This command would automatically initiate conda for zsh shell (writing things into <code>.zshrc</code> in your home directory).</p><blockquote><p>You may want to change conda mirros before creating any environments in China. See <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/">conda mirror help</a> for more information.</p></blockquote><h3 id="Create-Virtual-Environments">Create Virtual Environments</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda create -n test python=3.10</span><br></pre></td></tr></table></figure><p>This command creates a virtual environment named ml with python 3.10 installed.</p><h3 id="Activate-Deactivate-Virtual-Environments">Activate/Deactivate Virtual Environments</h3><p>The default virtual environment is “base”. Change to our “test” environment is quite simple:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda activate test</span><br></pre></td></tr></table></figure><p>Or deactivate it:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda deactivate</span><br></pre></td></tr></table></figure><h3 id="List-All-Environments">List All Environments</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">conda env list</span><br></pre></td></tr></table></figure><p>Pretty easy, hah.</p><h2 id="Package-Management">Package Management</h2><p>Although conda is able to handle both package and environment management. I prefer to use <code>pip</code> to install necessary packages. <code>pip</code> is included in any conda environment.</p><blockquote><p>Again, change pip mirros before install any packages in China. See <a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/">pip mirror help</a> for more information.</p></blockquote><h3 id="Install-Basic-Scientific-Packages">Install Basic Scientific Packages</h3><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">pip install numpy scipy pandas scikit-learn</span><br></pre></td></tr></table></figure><h3 id="Install-Basic-Visualizaiton-Packages">Install Basic Visualizaiton Packages</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install matplotlib seaborn pyqt5 </span><br></pre></td></tr></table></figure><p>Here I choose PyQt as the backend of matplotlib.</p><h3 id="Install-JupyterLab">Install JupyterLab</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install jupyterlab</span><br></pre></td></tr></table></figure><p>The following commands generate Jupyer server configuration files and set a password, so you can customize it yourself. The configuration files are in the <code>.jupyter</code> folder in your home directory.</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">jupyter server --generate-config</span><br><span class="line">jupyter server password</span><br></pre></td></tr></table></figure><p>We can start our scientific coding with Jupyter Lab, but I would recommend VS Code for a more comfortable coding experience. Now, let’s just start a Jupyter server without taking you to the default browser page:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">jupyter lab ---no-browser</span><br></pre></td></tr></table></figure><p>then we would go back into the VS Code configuration.</p><h2 id="VS-Code">VS Code</h2><p>VS Code is developed by Microsoft. It is a lightweight but powerful code editor which has a rich ecosystem of extensions for nearly every lanaguage.</p><p>Here I install the binary release from AUR:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yay -S visual-studio-code-bin</span><br></pre></td></tr></table></figure><h3 id="Basic-Extensions">Basic Extensions</h3><p>After starting the VS Code, install <code>Python</code> and <code>Jupyter</code> extensions from the extension market. And this pretty much sets everything up for Python development automatically.</p><h3 id="Python-Formatting">Python Formatting</h3><p>A formatter makes your code look clean and readable. In any Python file, hit <code>Ctrl+Shift+P</code> and type <code>format</code>, select <code>Format Document With</code> and hit <code>Python</code>. If you don’t have a formatter installed, VS Code would pop up a window to sugget you install a formatter. I personally choose <code>black</code> formatter.</p><p>Install <code>Black Formatter</code> extension. In settings, search <code>Format On Save</code> and put this on. Then you will be able to format each document automatically every time you hit save it. Below is a picture of how black formatter format your code.</p><img src="/vscode-python/formatter.png"><h3 id="Python-Debugging">Python Debugging</h3><p>The default Jupyter debug only steps through user-written code. To debug library code, open <code>Settings</code> by <code>Ctrl+,</code> and search <code>justmycode</code>, uncheck the option and restart the VS Code.</p><h3 id="Running-Jupyter-Notebook">Running Jupyter Notebook</h3><p>There are many ways to create a Jupyer notebook in VS Code (shortcuts, commands, etc). The most easy way is to create a new file named <code>xxx.ipynb</code> and you can directly open it in the VS Code.</p><img src="/vscode-python/vscode_jupyter.png"><p>The first thing is to make sure you select <strong>the right Python kernel or environment</strong> to run the notebook. You may have multiple choices. Then toggle the Jupyter server selection menu and select <code>Existing server</code>. You will be prompt to enter your Jupyter password.</p><img src="/vscode-python/vscode_start_debug.png"><p>Running cells in VS Code is almost the same as in the Jupyter browser app. Triggering debug mode requires clicking the debug cell button alongside each cell. Just like MATLAB, you can set multiple breakpoints and watch how variables change with the program.</p><img src="/vscode-python/vscode_debug.png"><h2 id="Docker-for-Deep-Learning">Docker for Deep Learning</h2><p>Docker allows you to package applications and their dependencies into isolated containers. One good reason for using Docker is that official PyTorch releases usually depend on older CUDA and cuDNN versions, whereas Arch-based distributions typically have the latest NVIDIA driver. This may cause unexpected failures during installation. For example, my CUDA version is 12.2 whereas the official suggested CUDA version of PyTorch is 11.8.</p><p>You can use Docker to create a container with a different version of NVIDIA CUDA than what you have installed locally on your machine. Docker containers are designed to be isolated environments that can run software with specific dependencies, regardless of what is installed on the host system.</p><h3 id="Install-Docker">Install Docker</h3><p>Install docker engine on Arch with these commands:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo pacman -S docker docker-compose</span><br><span class="line">sudo systemctl enable docker.service</span><br><span class="line">sudo systemctl start docker.service</span><br></pre></td></tr></table></figure><p>After that, add the current user to docker group:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo groupadd docker</span><br><span class="line">sudo usermod -aG docker $USER</span><br></pre></td></tr></table></figure><p>Log out and log in to verify successful installation by:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p>If everything works, it would pull a small image and print <code>hello world</code>.</p><p>My home directory is quite empty so I want to change docker default images location to my home directory:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">sudo systemctl stop docker.service</span><br><span class="line">sudo cp -r /var/lib/docker /home/swolf/docker</span><br></pre></td></tr></table></figure><p>Configure <code>data-root</code> in <code>/etc/docker/daemon.json</code>:</p><figure class="highlight text"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">     &quot;data-root&quot;: &quot;/home/swolf/docker&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Restart <code>docker.service</code> to apply these changes.</p><p>Perhaps you may need <code>docker-compose</code>:</p><figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">sudo pacman -S docker-compose</span><br></pre></td></tr></table></figure><h3 id="Install-NVIDIA-Container-Toolkit">Install NVIDIA Container Toolkit</h3><p>This is the most tricky part and I can not ensure my installation steps works for you. First, install <code>NVIDIA Container Toolkit</code> from AUR:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">yay -S nvidia-container-toolkit</span><br></pre></td></tr></table></figure><p>After that, restart <code>docker.service</code> and type:</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run --gpus all nvidia/cuda:11.8.0-runtime-ubuntu22.04 nvidia-smi</span><br></pre></td></tr></table></figure><p>and hope you can get the output of <code>nvidia-smi</code>.</p><h3 id="Build-A-Docker-Image-for-DL">Build A Docker Image for DL</h3><p>TODO</p></div><blockquote class="copyright"><p><strong>Link to this article : </strong><a class="permalink" href="https://mrswolf.github.io/vscode-python/">https://mrswolf.github.io/vscode-python/</a></p><p><strong>This article is available under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener noreferrer">Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0)</a> License</strong></p></blockquote></article></main><aside id="sidebar" class="aside aside-fixture"><div class="toc-sidebar"><nav id="toc" class="article-toc"><h3 class="toc-title">Catalogue</h3><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Virtual-Environment"><span class="toc-number">1.</span> <span class="toc-text">Virtual Environment</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Create-Virtual-Environments"><span class="toc-number">1.1.</span> <span class="toc-text">Create Virtual Environments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Activate-Deactivate-Virtual-Environments"><span class="toc-number">1.2.</span> <span class="toc-text">Activate&#x2F;Deactivate Virtual Environments</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#List-All-Environments"><span class="toc-number">1.3.</span> <span class="toc-text">List All Environments</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Package-Management"><span class="toc-number">2.</span> <span class="toc-text">Package Management</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-Basic-Scientific-Packages"><span class="toc-number">2.1.</span> <span class="toc-text">Install Basic Scientific Packages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-Basic-Visualizaiton-Packages"><span class="toc-number">2.2.</span> <span class="toc-text">Install Basic Visualizaiton Packages</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-JupyterLab"><span class="toc-number">2.3.</span> <span class="toc-text">Install JupyterLab</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#VS-Code"><span class="toc-number">3.</span> <span class="toc-text">VS Code</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Basic-Extensions"><span class="toc-number">3.1.</span> <span class="toc-text">Basic Extensions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Formatting"><span class="toc-number">3.2.</span> <span class="toc-text">Python Formatting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python-Debugging"><span class="toc-number">3.3.</span> <span class="toc-text">Python Debugging</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Running-Jupyter-Notebook"><span class="toc-number">3.4.</span> <span class="toc-text">Running Jupyter Notebook</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Docker-for-Deep-Learning"><span class="toc-number">4.</span> <span class="toc-text">Docker for Deep Learning</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-Docker"><span class="toc-number">4.1.</span> <span class="toc-text">Install Docker</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Install-NVIDIA-Container-Toolkit"><span class="toc-number">4.2.</span> <span class="toc-text">Install NVIDIA Container Toolkit</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Build-A-Docker-Image-for-DL"><span class="toc-number">4.3.</span> <span class="toc-text">Build A Docker Image for DL</span></a></li></ol></li></ol></nav></div></aside></section><footer class="hidden lg:block fixed bottom-0 left-0 sm:w-1/12 lg:w-1/6 bg-gray-100 z-40"><div class="footer-social-links"><a target="_blank" rel="noopener" href="https://github.com/mrswolf"><i class="iconfont icon-github"></i> </a><a href="/atom.xml"><i class="iconfont icon-rss"></i></a></div></footer><div id="mask" class="hidden mask fixed inset-0 bg-gray-900 opacity-75 z-40"></div><div id="search-view-container" class="hidden shadow-xl"></div><script src="/js/dom-event.min.js"></script><script src="/js/local-search.min.js"></script><script src="//cdn.jsdelivr.net/npm/lightgallery.js@1.1.3/dist/js/lightgallery.min.js"></script><script src="/js/light-gallery.min.js"></script></body></html>